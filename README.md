# نحوه استقرار (Deploy) پروژه لاراولی روی سرور مجازی (VPS) Ubuntu 24

### ابتدا به از طریق SSH به سرور خودتون متصل بشید
```sh
Syntax:- ssh -p PORT USERNAME@IP

Example:- ssh -p 22 root@192.168.1.1
```
**نکته** پورت پیش فرض 22 است اگر پورت را دستی عوضی کردید باید پورتی که ست کردید رو بجای 22 قرار بدید

### سرور رو اپدیت کنید
```sh
apt update && apt upgrade -y
```

### کاربر جدید بسازید

```sh
Syntax:- adduser $USERNAME

Example:- adduser admin
```
**نکته** بعد از اینکه این دستور رو وارد کنید ازتون رمز عبور این کاربر رو میخاد رمز عبور قوی رو بهش بدید بعد از اینکه رمز عبور رو بهش دادید اگر اطلاعاتی مثل اسم و شماره تلفن اینجور چیزا خواست با زدن دکمه اینتر میتونید رد بشید ازش و اگر هم دوست داشتید میتونید اون اطلاعات رو بدید بهش

### اعطا دسترسی ادمین به کاربر ساخته شده

```sh
Syntax:- usermod -aG sudo $USERNAME

Example:- usermod -aG sudo admin
```

### عوض کردن پورت و غیر فعال کردن ورود با کاربر root

دستور زیر رو اجرا کنید

```sh
nano /etc/ssh/sshd_config
```

سپس دنبال کلیدی با عنوان PORT بگردید اگر اولش # بود به این معنی هست که کامنت هستش اول از اون # حذف کنید بعدش جلوش یه عدد 4 یا 5 رقمی قرار بدید البته اون عدد که میشه همون پورت رو باید زخیره کنید یجا چون بعدا برای ورود به سرور بهش نیاز دارید

بعدش که پورت رو عوض کردید الان دنبال کلیدی با عنوان PermitRootLogin بگردید جلوش عبارت yes نوشته شده اون رو به no تغیر بدید بعدش با زدن دکمه های کنترل و x و سپس تایید تغیرات و سیو اون ها فایل براتون بسته میشه


### ری استارت کردن سرور برای اعمال همه تغیرات
خب الان که کانفیگ اولیه رو انجام دادید بهتره که سرور رو یبار ری استارت کنیم تا همه تغیرات اعمال بشه با دستور زیر میتونید سرور رو ری استارت کنید

```sh
reboot
```

**نکته**
حالا که ورود با کاربر روت رو جلوش رو گرفتیم و پورت رو عوض کردیم موقع SSH زدن به سرور باید با کاربری که خودمون ساختیم وارد بشیم و پورتی که خودمون ست کردیم رو هم توی SSH بزنیم برای مثال

```sh
Syntax:- ssh -p PORT USERNAME@IP

Example:- ssh -p 1413 admin@192.168.1.1
```

### نصب دیواره اتش (Firewall) و کانفیگ ان
داخل سرور ها برای اینکه امنیت سرور بالا بهبود پیدا کنه یه نرم افزاری رو نصب میکنن به اسم دیواره اتش که میاد برای ما ترافیک ورودی و ترافیک خروجی رو نحوه رفت امدشون رو مدیریت میکنه

```sh
sudo apt install ufw

sudo ufw enable

sudo ufw default deny incoming

sudo ufw default allow outgoing
```

**نکته**
نصب دیواره اتش باعث میشه که همه پورت های غیر اون های که ما واسش مشخص کردیم بسته بشه که خب این موضوع باعث میشه که ما نتونیم دیگ به سرور درخواست SSH بزنیم برای ورود پس باید پورت SSH رو باز کنیم با دستور زیر میتونید یه پورت مشخصی رو برای سرور باز کنید

```sh
Syntax:- sudo ufw allow PORT

Example:- sudo ufw allow 1413
```
**نکته**
شما باید پورتی که برای خودتون ست کردید رو باز کنید نه بقیه پورت هارو


### باز کردن پورت درخواست های HTTP و HTTPS

با زدن دستور های زیر کاربر ها میتونن به سرور شما درخواست بدن برای دیدن سایت پس حتما باید این دوتا پورت رو باز کنید

```sh
sudo ufw allow http

sudo ufw allow https
```

### نصب محافظ SSH
برای محافظت بیشتر از SSH و پورتی که برای اون باز هست و جلوگیری از یه سری حمله ها بهتره که SSH GUARD رو نصب کنیم

```sh
sudo apt install sshguard
```

### نصب وب سرور NGINX

```sh
sudo apt install nginx -y

sudo systemctl enable nginx
```

### نصب ورژن کنترلر GIT

```sh
sudo apt install  git -y
```
